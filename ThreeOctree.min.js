(function(e){function c(f){return !isNaN(f)&&isFinite(f)}function b(f){return Object.prototype.toString.call(f)==="[object Array]"}function d(f){return f?(b(f)!==true?[f]:f):[]}function a(j,h){for(var g=0,f=j.length;g<f;g++){if(j[g]===h){return g}}return -1}e.Octree=function(f){f=f||{};f.tree=this;this.nodeCount=0;this.INDEX_INSIDE_CROSS=-1;this.INDEX_OUTSIDE_OFFSET=2;this.INDEX_OUTSIDE_POS_X=c(f.INDEX_OUTSIDE_POS_X)?f.INDEX_OUTSIDE_POS_X:0;this.INDEX_OUTSIDE_NEG_X=c(f.INDEX_OUTSIDE_NEG_X)?f.INDEX_OUTSIDE_NEG_X:1;this.INDEX_OUTSIDE_POS_Y=c(f.INDEX_OUTSIDE_POS_Y)?f.INDEX_OUTSIDE_POS_Y:2;this.INDEX_OUTSIDE_NEG_Y=c(f.INDEX_OUTSIDE_NEG_Y)?f.INDEX_OUTSIDE_NEG_Y:3;this.INDEX_OUTSIDE_POS_Z=c(f.INDEX_OUTSIDE_POS_Z)?f.INDEX_OUTSIDE_POS_Z:4;this.INDEX_OUTSIDE_NEG_Z=c(f.INDEX_OUTSIDE_NEG_Z)?f.INDEX_OUTSIDE_NEG_Z:5;this.INDEX_OUTSIDE_MAP=[];this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_POS_X]={index:this.INDEX_OUTSIDE_POS_X,count:0,x:1,y:0,z:0};this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_NEG_X]={index:this.INDEX_OUTSIDE_NEG_X,count:0,x:-1,y:0,z:0};this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_POS_Y]={index:this.INDEX_OUTSIDE_POS_Y,count:0,x:0,y:1,z:0};this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_NEG_Y]={index:this.INDEX_OUTSIDE_NEG_Y,count:0,x:0,y:-1,z:0};this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_POS_Z]={index:this.INDEX_OUTSIDE_POS_Z,count:0,x:0,y:0,z:1};this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_NEG_Z]={index:this.INDEX_OUTSIDE_NEG_Z,count:0,x:0,y:0,z:-1};this.FLAG_POS_X=1<<(this.INDEX_OUTSIDE_POS_X+1);this.FLAG_NEG_X=1<<(this.INDEX_OUTSIDE_NEG_X+1);this.FLAG_POS_Y=1<<(this.INDEX_OUTSIDE_POS_Y+1);this.FLAG_NEG_Y=1<<(this.INDEX_OUTSIDE_NEG_Y+1);this.FLAG_POS_Z=1<<(this.INDEX_OUTSIDE_POS_Z+1);this.FLAG_NEG_Z=1<<(this.INDEX_OUTSIDE_NEG_Z+1);this.utilVec31Search=new e.Vector3();this.utilVec32Search=new e.Vector3();this.scene=f.scene;this.objects=[];this.objectsData=[];this.depthMax=c(f.depthMax)?f.depthMax:-1;this.objectsThreshold=c(f.objectsThreshold)?f.objectsThreshold:8;this.overlapPct=c(f.overlapPct)?f.overlapPct:0.15;this.root=f.root instanceof e.OctreeNode?f.root:new e.OctreeNode(f)};e.Octree.prototype={setRoot:function(f){if(f instanceof e.OctreeNode){this.root=f;this.root.updateProperties()}},add:function(j,r){var k,h,n,p,f,g,o,m,q;if(j instanceof e.OctreeObjectData){j=j.object}n=a(this.objects,j);if(n===-1){this.objects.push(j);this.updateObject(j);if(r){g=r.useFaces;m=r.useVertices}if(m===true){p=j.geometry;o=p.vertices;for(k=0,h=o.length;k<h;k++){this.addObjectData(j,o[k])}}else{if(g===true){p=j.geometry;f=p.faces;for(k=0,h=f.length;k<h;k++){this.addObjectData(j,f[k])}}else{this.addObjectData(j)}}}},addObjectData:function(h,g){var f=new e.OctreeObjectData(h,g);this.objectsData.push(f);this.root.addObject(f)},remove:function(j){var k,f,h=j,g,m;if(j instanceof e.OctreeObjectData){j=j.object}g=a(this.objects,j);if(g!==-1){this.objects.splice(g,1);m=this.root.removeObject(h);for(k=0,f=m.length;k<f;k++){h=m[k];g=a(this.objectsData,h);if(g!==-1){this.objectsData.splice(g,1)}}}},extend:function(h){var k,g,f,j;if(h instanceof e.Octree){f=h.objectsData;for(k=0,g=f.length;k<g;k++){j=f[k];this.add(j,j.faces)}}},update:function(){var k,f,n,h,g,m,o,j=[];for(k=0,f=this.objects.length;k<f;k++){h=this.objects[k];this.updateObject(h)}for(k=0,f=this.objectsData.length;k<f;k++){g=this.objectsData[k];n=g.node;g.update();if(n instanceof e.OctreeNode&&!g.positionLast.equals(g.position)){o=g.indexOctant;m=n.getOctantIndex(g);if(m!==o){j.push(g)}}}for(k=0,f=j.length;k<f;k++){g=j[k];g.node.removeObject(g);this.root.addObject(g)}},search:function(o,r,q,t){var n,j,h,v,u,k,m,g,f,s,p;v=[].concat(this.root.objects);if(c(r)!==true){r=Number.MAX_VALUE}if(t instanceof e.Vector3){t=this.utilVec31Search.copy(t).normalize();p=this.utilVec32Search.set(1,1,1).divide(t)}for(n=0,j=this.root.nodesIndices.length;n<j;n++){h=this.root.nodesByIndex[this.root.nodesIndices[n]];v=h.search(o,r,v,t,p)}if(q===true){m=[];f=[];for(n=0,j=v.length;n<j;n++){u=v[n];k=u.object;s=a(f,k);if(s===-1){g={object:k,faces:[],vertices:[]};m.push(g);f.push(k)}else{g=m[s]}if(u.faces){g.faces.push(u.faces)}else{if(u.vertices){g.vertices.push(u.vertices)}}}}else{m=v}return m},updateObject:function(h){var j,f,m=[h],k,g;k=h.parent;while(k){m.push(k);k=k.parent}for(j=0,f=m.length;j<f;j++){k=m[j];if(k.matrixWorldNeedsUpdate===true){g=k}}if(typeof g!=="undefined"){g.updateMatrixWorld()}},getDepthEnd:function(){return this.root.getDepthEnd()},getNodeCountEnd:function(){return this.root.getNodeCountEnd()},getObjectCountEnd:function(){return this.root.getObjectCountEnd()},toConsole:function(){this.root.toConsole()}};e.OctreeObjectData=function(g,f){this.object=g;if(f instanceof e.Face3){this.faces=f;this.face3=true;this.utilVec31FaceBounds=new e.Vector3()}else{if(f instanceof e.Face4){this.face4=true;this.faces=f;this.utilVec31FaceBounds=new e.Vector3()}else{if(f instanceof e.Vector3){this.vertices=f}}}this.radius=0;this.position=new e.Vector3();if(this.object instanceof e.Object3D){this.update()}this.positionLast=this.position.clone()};e.OctreeObjectData.prototype={update:function(){if(this.face3){this.radius=this.getFace3BoundingRadius(this.object,this.faces);this.position.copy(this.faces.centroid).applyMatrix4(this.object.matrixWorld)}else{if(this.face4){this.radius=this.getFace4BoundingRadius(this.object,this.faces);this.position.copy(this.faces.centroid).applyMatrix4(this.object.matrixWorld)}else{if(this.vertices){this.radius=this.object.material.size||1;this.position.copy(this.vertices).applyMatrix4(this.object.matrixWorld)}else{this.radius=this.object.geometry instanceof e.Geometry?this.object.geometry.boundingSphere.radius:this.object.boundRadius;this.position.getPositionFromMatrix(this.object.matrixWorld)}}}this.radius=this.radius*Math.max(this.object.scale.x,this.object.scale.y,this.object.scale.z)},getFace3BoundingRadius:function(h,k){var n=h.geometry||h,j=n.vertices,f=k.centroid,o=j[k.a],m=j[k.b],l=j[k.c],g=this.utilVec31FaceBounds,i;f.addVectors(o,m).add(l).divideScalar(3);i=Math.max(g.subVectors(f,o).length(),g.subVectors(f,m).length(),g.subVectors(f,l).length());return i},getFace4BoundingRadius:function(h,l){var o=h.geometry||h,k=o.vertices,f=l.centroid,p=k[l.a],n=k[l.b],m=k[l.c],j=k[l.d],g=this.utilVec31FaceBounds,i;f.addVectors(p,n).add(m).add(j).divideScalar(4);i=Math.max(g.subVectors(f,p).length(),g.subVectors(f,n).length(),g.subVectors(f,m).length(),g.subVectors(f,j).length());return i}};e.OctreeNode=function(f){this.utilVec31Branch=new e.Vector3();this.utilVec31Expand=new e.Vector3();this.utilVec31Ray=new e.Vector3();f=f||{};if(f.tree instanceof e.Octree){this.tree=f.tree}else{if(f.parent instanceof e.OctreeNode!==true){f.root=this;this.tree=new e.Octree(f)}}this.id=this.tree.nodeCount++;this.position=f.position instanceof e.Vector3?f.position:new e.Vector3();this.radius=c(f.radius)&&f.radius>0?f.radius:1;this.indexOctant=f.indexOctant;this.depth=0;this.reset();this.setParent(f.parent);this.overlap=this.radius*this.tree.overlapPct;this.radiusOverlap=this.radius+this.overlap;this.left=this.position.x-this.radiusOverlap;this.right=this.position.x+this.radiusOverlap;this.bottom=this.position.y-this.radiusOverlap;this.top=this.position.y+this.radiusOverlap;this.back=this.position.z-this.radiusOverlap;this.front=this.position.z+this.radiusOverlap;if(this.tree.scene){this.visual=new e.Mesh(new e.CubeGeometry(this.radiusOverlap*2,this.radiusOverlap*2,this.radiusOverlap*2),new e.MeshBasicMaterial({color:16711680,wireframe:true,wireframeLinewidth:1}));this.visual.position.copy(this.position);this.tree.scene.add(this.visual)}};e.OctreeNode.prototype={setParent:function(f){if(f!==this&&this.parent!==f){this.parent=f;this.updateProperties()}},updateProperties:function(){var g,f;if(this.parent instanceof e.OctreeNode){this.tree=this.parent.tree;this.depth=this.parent.depth+1}else{this.depth=0}for(g=0,f=this.nodesIndices.length;g<f;g++){this.nodesByIndex[this.nodesIndices[g]].updateProperties()}},reset:function(g,m){var h,f,j,k=this.nodesIndices||[],n=this.nodesByIndex;this.objects=[];this.nodesIndices=[];this.nodesByIndex={};for(h=0,f=k.length;h<f;h++){j=n[k[h]];j.setParent(undefined);if(g===true){j.reset(g,m)}}if(m===true&&this.visual&&this.visual.parent){this.visual.parent.remove(this.visual)}},addNode:function(g,f){f=g.indexOctant=c(f)?f:c(g.indexOctant)?g.indexOctant:this.getOctantIndex(g);if(a(this.nodesIndices,f)===-1){this.nodesIndices.push(f)}this.nodesByIndex[f]=g;if(g.parent!==this){g.setParent(this)}},removeNode:function(g){var h=-1,f,i;if(g instanceof e.OctreeNode&&this.nodesByIndex[g.indexOctant]===g){i=g;h=i.indexOctant}else{if(c(g)){h=g}else{for(f in this.nodesByIndex){i=this.nodesByIndex[f];if(i===g){h=f;break}}}}if(h!==-1){f=a(this.nodesIndices,h);this.nodesIndices.splice(f,1);i=i||this.nodesByIndex[h];delete this.nodesByIndex[h];if(i.parent===this){i.setParent(undefined)}}},addObject:function(g){var f,h,i;h=this.getOctantIndex(g);if(h>-1&&this.nodesIndices.length>0){i=this.branch(h);i.addObject(g)}else{if(h<-1&&this.parent instanceof e.OctreeNode){this.parent.addObject(g)}else{f=a(this.objects,g);if(f===-1){this.objects.push(g)}g.node=this;this.checkGrow()}}},addObjectWithoutCheck:function(j){var h,f,g;for(h=0,f=j.length;h<f;h++){g=j[h];this.objects.push(g);g.node=this}},removeObject:function(g){var h,f,j,k;k=this.removeObjectRecursive(g,{searchComplete:false,nodesRemovedFrom:[],objectsDataRemoved:[]});j=k.nodesRemovedFrom;if(j.length>0){for(h=0,f=j.length;h<f;h++){j[h].shrink()}}return k.objectsDataRemoved},removeObjectRecursive:function(j,o){var k,f,h=-1,g,n,m;if(j instanceof e.OctreeObjectData){h=a(this.objects,j);if(h!==-1){this.objects.splice(h,1);j.node=undefined;o.objectsDataRemoved.push(j);o.searchComplete=m=true}}else{for(k=this.objects.length-1;k>=0;k--){g=this.objects[k];if(g.object===j){this.objects.splice(k,1);g.node=undefined;o.objectsDataRemoved.push(g);m=true;if(!g.faces&&!g.vertices){o.searchComplete=true;break}}}}if(m===true){o.nodesRemovedFrom.push(this)}if(o.searchComplete!==true){for(k=0,f=this.nodesIndices.length;k<f;k++){n=this.nodesByIndex[this.nodesIndices[k]];o=n.removeObjectRecursive(j,o);if(o.searchComplete===true){break}}}return o},checkGrow:function(){if(this.objects.length>this.tree.objectsThreshold&&this.tree.objectsThreshold>0){this.grow()}},grow:function(){var f,k,g=[],h=[],n=[],p=[],o=[],m,j;for(m=0,j=this.objects.length;m<j;m++){k=this.objects[m];f=this.getOctantIndex(k);if(f>-1){n.push(k);p.push(f)}else{if(f<-1){g.push(k);h.push(f)}else{o.push(k)}}}if(n.length>0){o=o.concat(this.split(n,p))}if(g.length>0){o=o.concat(this.expand(g,h))}this.objects=o;this.checkMerge()},split:function(o,g){var j,f,m,h,n,k;if(this.tree.depthMax<0||this.depth<this.tree.depthMax){o=o||this.objects;g=g||[];k=[];for(j=0,f=o.length;j<f;j++){h=o[j];m=c(g[j])?g[j]:this.getOctantIndex(h);if(m>-1){n=this.branch(m);n.addObject(h)}else{k.push(h)}}if(o===this.objects){this.objects=k}}else{k=this.objects}return k},branch:function(j){var k,i,g,h,l,f;if(this.nodesByIndex[j] instanceof e.OctreeNode){k=this.nodesByIndex[j]}else{g=(this.radiusOverlap)*0.5;i=g*this.tree.overlapPct;h=g-i;l=this.utilVec31Branch.set(j&1?h:-h,j&2?h:-h,j&4?h:-h);f=new e.Vector3().addVectors(this.position,l);k=new e.OctreeNode({tree:this.tree,parent:this,position:f,radius:g,indexOctant:j});this.addNode(k,j)}return k},expand:function(g,K){var G,F,O,I,L,h,t,x,p,z=this.tree.INDEX_OUTSIDE_MAP,v,C,A,y,n,k,E,D,B,J,H,s,r,q,f,m,M,j,w,o=this.utilVec31Expand,N,u;if(this.tree.depthMax<0||this.tree.root.getDepthEnd()<this.tree.depthMax){g=g||this.objects;K=K||[];I=[];L=[];for(G=0,F=z.length;G<F;G++){z[G].count=0}for(G=0,F=g.length;G<F;G++){O=g[G];h=c(K[G])?K[G]:this.getOctantIndex(O);if(h<-1){t=-h-this.tree.INDEX_OUTSIDE_OFFSET;if(t&this.tree.FLAG_POS_X){z[this.tree.INDEX_OUTSIDE_POS_X].count++}else{if(t&this.tree.FLAG_NEG_X){z[this.tree.INDEX_OUTSIDE_NEG_X].count++}}if(t&this.tree.FLAG_POS_Y){z[this.tree.INDEX_OUTSIDE_POS_Y].count++}else{if(t&this.tree.FLAG_NEG_Y){z[this.tree.INDEX_OUTSIDE_NEG_Y].count++}}if(t&this.tree.FLAG_POS_Z){z[this.tree.INDEX_OUTSIDE_POS_Z].count++}else{if(t&this.tree.FLAG_NEG_Z){z[this.tree.INDEX_OUTSIDE_NEG_Z].count++}}L.push(O)}else{I.push(O)}}if(L.length>0){v=z.slice(0);v.sort(function(l,i){return i.count-l.count});C=v[0];n=C.index|1;E=v[1];D=v[2];A=(E.index|1)!==n?E:D;k=A.index|1;E=v[2];D=v[3];B=v[4];J=E.index|1;H=D.index|1;y=J!==n&&J!==k?E:H!==n&&H!==k?D:B;s=C.x+A.x+y.x;r=C.y+A.y+y.y;q=C.z+A.z+y.z;h=this.getOctantIndexFromPosition(s,r,q);p=this.getOctantIndexFromPosition(-s,-r,-q);f=this.overlap;m=this.radius;j=this.tree.overlapPct>0?f/((0.5*this.tree.overlapPct)*(1+this.tree.overlapPct)):m*2;w=j*this.tree.overlapPct;M=(j+w)-(m+f);o.set(h&1?M:-M,h&2?M:-M,h&4?M:-M);N=new e.Vector3().addVectors(this.position,o);u=new e.OctreeNode({tree:this.tree,position:N,radius:j});u.addNode(this,p);this.tree.setRoot(u);for(G=0,F=L.length;G<F;G++){this.tree.root.addObject(L[G])}}if(g===this.objects){this.objects=I}}else{I=g}return I},shrink:function(){this.checkMerge();this.tree.root.checkContract()},checkMerge:function(){var f=this,g;while(f.parent instanceof e.OctreeNode&&f.getObjectCountEnd()<this.tree.objectsThreshold){g=f;f=f.parent}if(f!==this){f.merge(g)}},merge:function(h){var n,f,m,g,o;h=d(h);for(n=0,f=h.length;n<f;n++){o=h[n];this.addObjectWithoutCheck(o.getObjectsEnd());o.reset(true,true);this.removeNode(o.indexOctant,o)}this.checkMerge()},checkContract:function(){var k,h,n,m,g,f,j;if(this.nodesIndices.length>0){f=0;j=this.objects.length;for(k=0,h=this.nodesIndices.length;k<h;k++){n=this.nodesByIndex[this.nodesIndices[k]];m=n.getObjectCountEnd();j+=m;if(g instanceof e.OctreeNode===false||m>f){g=n;f=m}}j-=f;if(j<this.tree.objectsThreshold&&g instanceof e.OctreeNode){this.contract(g)}}},contract:function(j){var g,f,h;for(g=0,f=this.nodesIndices.length;g<f;g++){h=this.nodesByIndex[this.nodesIndices[g]];if(h!==j){j.addObjectWithoutCheck(h.getObjectsEnd());h.reset(true,true)}}j.addObjectWithoutCheck(this.objects);this.reset(false,true);this.tree.setRoot(j);j.checkContract()},getOctantIndex:function(w){var o,j,m,r,p=this.position,u=this.radiusOverlap,v=this.overlap,n,k,h,t,s,q,g,f=0;if(w instanceof e.OctreeObjectData){r=w.radius;m=w.position;w.positionLast.copy(m)}else{if(w instanceof e.OctreeNode){m=w.position;r=0}}n=m.x-p.x;k=m.y-p.y;h=m.z-p.z;t=Math.abs(n);s=Math.abs(k);q=Math.abs(h);g=Math.max(t,s,q);if(g+r>u){if(t+r>u){f=f^(n>0?this.tree.FLAG_POS_X:this.tree.FLAG_NEG_X)}if(s+r>u){f=f^(k>0?this.tree.FLAG_POS_Y:this.tree.FLAG_NEG_Y)}if(q+r>u){f=f^(h>0?this.tree.FLAG_POS_Z:this.tree.FLAG_NEG_Z)}w.indexOctant=-f-this.tree.INDEX_OUTSIDE_OFFSET;return w.indexOctant}if(n-r>-v){f=f|1}else{if(!(n+r<v)){w.indexOctant=this.tree.INDEX_INSIDE_CROSS;return w.indexOctant}}if(k-r>-v){f=f|2}else{if(!(k+r<v)){w.indexOctant=this.tree.INDEX_INSIDE_CROSS;return w.indexOctant}}if(h-r>-v){f=f|4}else{if(!(h+r<v)){w.indexOctant=this.tree.INDEX_INSIDE_CROSS;return w.indexOctant}}w.indexOctant=f;return w.indexOctant},getOctantIndexFromPosition:function(f,i,h){var g=0;if(f>0){g=g|1}if(i>0){g=g|2}if(h>0){g=g|4}return g},search:function(j,n,p,o,k){var h,g,f,m;if(o){m=this.intersectRay(j,o,n,k)}else{m=this.intersectSphere(j,n)}if(m===true){p=p.concat(this.objects);for(h=0,g=this.nodesIndices.length;h<g;h++){f=this.nodesByIndex[this.nodesIndices[h]];p=f.search(j,n,p,o)}}return p},intersectSphere:function(g,f){var k=f*f,j=g.x,i=g.y,h=g.z;if(j<this.left){k-=Math.pow(j-this.left,2)}else{if(j>this.right){k-=Math.pow(j-this.right,2)}}if(i<this.bottom){k-=Math.pow(i-this.bottom,2)}else{if(i>this.top){k-=Math.pow(i-this.top,2)}}if(h<this.back){k-=Math.pow(h-this.back,2)}else{if(h>this.front){k-=Math.pow(h-this.front,2)}}return k>=0},intersectRay:function(q,p,f,o){if(typeof o==="undefined"){o=this.utilVec31Ray.set(1,1,1).divide(p)}var n=(this.left-q.x)*o.x,m=(this.right-q.x)*o.x,k=(this.bottom-q.y)*o.y,j=(this.top-q.y)*o.y,i=(this.back-q.z)*o.z,h=(this.front-q.z)*o.z,l=Math.min(Math.min(Math.max(n,m),Math.max(k,j)),Math.max(i,h)),g;if(l<0){return false}g=Math.max(Math.max(Math.min(n,m),Math.min(k,j)),Math.min(i,h));if(g>l||g>f){return false}return true},getDepthEnd:function(j){var g,f,h;if(this.nodesIndices.length>0){for(g=0,f=this.nodesIndices.length;g<f;g++){h=this.nodesByIndex[this.nodesIndices[g]];j=h.getDepthEnd(j)}}else{j=!j||this.depth>j?this.depth:j}return j},getNodeCountEnd:function(){return this.tree.root.getNodeCountRecursive()+1},getNodeCountRecursive:function(){var g,f,h=this.nodesIndices.length;for(g=0,f=this.nodesIndices.length;g<f;g++){h+=this.nodesByIndex[this.nodesIndices[g]].getNodeCountRecursive()}return h},getObjectsEnd:function(j){var g,f,h;j=(j||[]).concat(this.objects);for(g=0,f=this.nodesIndices.length;g<f;g++){h=this.nodesByIndex[this.nodesIndices[g]];j=h.getObjectsEnd(j)}return j},getObjectCountEnd:function(){var g,f,h=this.objects.length;for(g=0,f=this.nodesIndices.length;g<f;g++){h+=this.nodesByIndex[this.nodesIndices[g]].getObjectCountEnd()}return h},getObjectCountStart:function(){var g=this.objects.length,f=this.parent;while(f instanceof e.OctreeNode){g+=f.objects.length;f=f.parent}return g},toConsole:function(j){var g,f,h,k="   ";j=typeof j==="string"?j:k;console.log((this.parent?j+" octree NODE > ":" octree ROOT > "),this," // id: ",this.id," // indexOctant: ",this.indexOctant," // position: ",this.position.x,this.position.y,this.position.z," // radius: ",this.radius," // depth: ",this.depth);console.log((this.parent?j+" ":" "),"+ objects ( ",this.objects.length," ) ",this.objects);console.log((this.parent?j+" ":" "),"+ children ( ",this.nodesIndices.length," )",this.nodesIndices,this.nodesByIndex);for(g=0,f=this.nodesIndices.length;g<f;g++){h=this.nodesByIndex[this.nodesIndices[g]];h.toConsole(j+k)}}};e.Raycaster.prototype.intersectOctreeObject=function(h,g){var j,k,i,f;if(h.object instanceof e.Object3D){k=h;h=k.object;f=k.faces;i=h.geometry.faces;if(f.length>0){h.geometry.faces=f}j=this.intersectObject(h,g);if(f.length>0){h.geometry.faces=i}}else{j=this.intersectObject(h,g)}return j};e.Raycaster.prototype.intersectOctreeObjects=function(k,g){var h,f,j=[];for(h=0,f=k.length;h<f;h++){j=j.concat(this.intersectOctreeObject(k[h],g))}return j}}(THREE));